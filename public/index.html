<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <meta http-equiv="X-UA-Compatible" content="ie=edge">
    <title>Kosz</title>
    <link rel="stylesheet" href="main.css">
    <link rel="stylesheet" type="text/css" href="https://fonts.googleapis.com/icon?family=Material+Icons" />

    <meta name="theme-color" content="#1D1B27">
</head>
<body>
    <div id="app">
        
        <div id="login_form" v-if="!logged_in">
            <div id="login_wrap">
                <div id="login_error" v-if="loginerror.error">
                    <b>Bejelentkezési hiba</b> {{ loginerror.message }}
                </div>
                <h1>Jelentkezzen be!</h1>
                <form action="/api/login">
                    <input type="text" placeholder="Intézmény keresése" oninput="data.inst_search = this.value">
                    <div id="schools">
                        <div v-for="school in searchSchool(inst_search)" class="school">
                            
                            <input type="radio" name="inst" :value="school.InstituteCode" :id="school.InstituteCode" checked>
                            <span class="checkmark">
                                <!-- <i class="material-icons left">check</i> -->
                            </span>
                            <label :for="school.InstituteCode"> {{ school.Name }}
                                <i>({{ school.City }})</i>
                            </label>
                            
                        </div>
                        <div v-if="searchSchool(inst_search).length == 0">
                            A keresett intézményre nincs találat
                        </div>
                    </div>
                    <span id="selected_inst">{{ selected_inst }}</span>
                    <input name="username" type="text" placeholder="Felhasználónév" autocomplete="username">
                    <input name="password" type="password" placeholder="Jelszó" autocomplete="current-password">
                    <input type="submit" value="Bejelentkezés">
                </form>
            </div>
            
        </div>
        <div id="app_screen" v-if="logged_in">
            <div id="home" v-if="page == 'home'">
                <div id="avg_screen">
                    <div id="circle_container">
                        <progress-ring id="avg_circle" :stroke-color="rank().color" :radius="120/2" :progress="avg_percent()" :stroke="6"></progress-ring>
                        <span id="total_avg"><span id="total_avg_text">{{ name_abbriv() }}</span></span>
                    </div>
                    <div id="avg_detail_cont">
                        <span class="section avg">
                            
                            <i class="material-icons left">equalizer</i>
                            <span class="right">
                                <span class="big">
                                    {{ format(average) }}
                                </span>
                                <span class="small">Átlag</span>
                            </span>
                            
                        </span>

                        <span class="divider"></span>

                        <span class="section rank">
                            
                            <i class="material-icons left">stars</i>
                            <span class="right">
                                <span class="big">
                                    {{ rank().name }}
                                </span>
                                <span class="small">Rank</span>
                            </span>
                            
                        </span>
                    </div>
                </div>
                <ul id="subjects">
                    <li v-for="(subject, index) in subjects" class="subject">
                        <div class="subject_header">
                            <span class="left">{{ subject.name }}</span>
                            <span class="right">
                                <span>{{ format(subject.average) }}</span>
                                <i class="material-icons" v-bind:class="{ up: isRoundedUp(subject) }">
                                    arrow_right_alt
                                </i>
                                <span>{{ roundSubject(subject) }}</span>
                            </span>
                            
                        </div>
                        <div class="subject_grades">
                            <span class="tinygrade" v-for="grade in subject.grades">{{ grade.value }}</span>
                        </div>
                    </li>
                </ul>
            </div>
            <div v-if="page=='recent'" id="recent">
                <h1>Jegyek</h1>
                <ul id="grades">
                    <li v-for="(grade, index) in grades" class="grade">
                        
                            <span class="left">{{ grade.value }}</span>
                            <span class="right">
                                <div class="grade_header">
                                    {{ grade.subject }}
                                </div>
                                <span class="bottom">{{ grade.mode }}</span>
                            </span>
                        
                    </li>
                </ul>
            </div>
            <div v-if="page=='info'">
                <h1>{{ fullname }}</h1>
            </div>
            
        </div>
        <nav v-if="logged_in" id="menu">
            <button v-bind:class="{ active: page=='home' }" v-on:click="page = 'home'">
                <svg class="feather">
                    <use xlink:href="/node_modules/feather-icons/dist/feather-sprite.svg#home"/>
                </svg>
                <!-- <i class="material-icons">home</i> -->
            </button>
            <button v-bind:class="{ active: page=='recent' }" v-on:click="page = 'recent'">
                <svg class="feather">
                    <use xlink:href="/node_modules/feather-icons/dist/feather-sprite.svg#clock"/>
                </svg>
                <!-- <i class="material-icons">history</i> -->
            </button>
            <button v-bind:class="{ active: page=='info' }" v-on:click="page = 'info'">
                <svg class="feather">
                    <use xlink:href="/node_modules/feather-icons/dist/feather-sprite.svg#user"/>
                </svg>
                
                <!-- <i class="material-icons">account_circle</i> -->
            </button>
        </nav>
        <div v-if="loading" id="loading_screen">
            <div class="lds-ring"><div></div><div></div><div></div><div></div></div>
        </div>
    </div>
    <script src="https://cdn.jsdelivr.net/npm/vue/dist/vue.js"></script>
    <script src="node_modules/jaaulde-cookies/lib/jaaulde-cookies.js"></script>
    <script src="main.js"></script>
</body>
</html>